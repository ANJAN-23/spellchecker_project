<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Spell Checker & Autocomplete</title>
<style>
  /* ----------------- GLOBAL ----------------- */
  * { box-sizing: border-box; }
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background: #121212;
    color: #e0e0e0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 2rem;
  }
  h2 { color: #b3ff00; margin-bottom: 1rem; text-align: center; }
  .container {
    background: #1f1f1f;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.7);
    padding: 2rem;
    width: 95%;
    max-width: 700px;
    margin-bottom: 2rem;
    transition: transform 0.3s ease;
  }
  .container:hover {
    transform: translateY(-5px);
  }
  input, textarea {
    width: 100%;
    padding: 0.7rem;
    margin: 0.5rem 0;
    font-size: 1rem;
    border: 1px solid #444;
    border-radius: 8px;
    background: #2c2c2c;
    color: #e0e0e0;
  }
  input::placeholder, textarea::placeholder { color: #888; }
  button {
    padding: 0.7rem 1.5rem;
    font-size: 1rem;
    color: #121212;
    background: #b3ff00;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin-top: 0.5rem;
    font-weight: bold;
    transition: all 0.3s ease;
  }
  button:hover {
    background: #00ff88;
    color: #fff;
  }
  pre {
    background: #2c2c2c;
    padding: 1rem;
    border-radius: 8px;
    font-size: 1rem;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  ul {
    list-style: none;
    padding-left: 0;
    background: #2c2c2c;
    border-radius: 8px;
    max-height: 180px;
    overflow-y: auto;
  }
  ul li {
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  ul li:hover { background: #444; }

  /* FOOTER */
  footer {
    text-align: center;
    margin-top: 2rem;
    font-size: 0.9rem;
    color: #888;
  }
</style>
</head>
<body>

<!-- ================= Register ================= -->
<div class="container">
  <h2>üë§ Register</h2>
  <input type="text" id="regUsername" placeholder="Username" />
  <input type="password" id="regPassword" placeholder="Password" />
  <button onclick="registerUser()">Register</button>
  <pre id="registerResult">Status will appear here...</pre>
</div>

<!-- ================= Login ================= -->
<div class="container">
  <h2>üîë Login</h2>
  <input type="text" id="loginUsername" placeholder="Username" />
  <input type="password" id="loginPassword" placeholder="Password" />
  <button onclick="loginUser()">Login</button>
  <pre id="loginResult">Status will appear here...</pre>
</div>

<!-- ================= Spell Checker ================= -->
<div class="container">
  <h2>üìù Spell Checker</h2>
  <textarea id="text" placeholder="Type your sentence here..."></textarea>
  <button onclick="checkSpelling()">Check Spelling</button>
  <pre id="output">Your result will appear here...</pre>
</div>

<!-- ================= Autocomplete ================= -->
<div class="container">
  <h2>‚ö° Autocomplete</h2>
  <input type="text" id="prefix" placeholder="Type prefix..." />
  <ul id="autoList"></ul>
</div>

<!-- FOOTER -->
<footer>
  Made by Team Avengers: Anjan (Team Lead), Shahid, Anshul, Kartik
</footer>

<script>
/* -------------------------------
          HELPER FUNCTION
-------------------------------- */
function showMessage(element, message, type="info") {
    const emoji = type === "error" ? "‚ö†Ô∏è" : type === "success" ? "‚úÖ" : "‚è≥";
    element.textContent = `${emoji} ${message}`;
}

/* -------------------------------
       USER AUTH FUNCTIONS
-------------------------------- */
async function registerUser() {
    const username = document.getElementById('regUsername').value.trim();
    const password = document.getElementById('regPassword').value.trim();
    const result = document.getElementById('registerResult');

    if (!username || !password) return showMessage(result, "Fill both fields!", "error");

    try {
        const res = await fetch('http://localhost:3000/auth/register', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });
        const data = await res.json();
        showMessage(result, data.message || "Registered successfully!", "success");
    } catch (err) {
        showMessage(result, "Network error: " + err.message, "error");
    }
}

async function loginUser() {
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value.trim();
    const result = document.getElementById('loginResult');

    if (!username || !password) return showMessage(result, "Fill both fields!", "error");

    try {
        const res = await fetch('http://localhost:3000/auth/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });
        const data = await res.json();
        if (res.ok) {
            localStorage.setItem('token', data.token || "dummy-token");
            showMessage(result, "Logged in successfully!", "success");
        } else {
            showMessage(result, data.message || "Login failed", "error");
        }
    } catch (err) {
        showMessage(result, "Network error: " + err.message, "error");
    }
}

/* -------------------------------
       SPELLCHECK FUNCTION
-------------------------------- */
async function checkSpelling() {
    const text = document.getElementById('text').value.trim();
    const output = document.getElementById('output');

    if (!text) return showMessage(output, "Please enter text!", "error");

    showMessage(output, "Checking spelling...");

    try {
        const res = await fetch('http://localhost:3000/spellcheck', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ text })
        });
        const data = await res.json();
        showMessage(output, data.corrected || "No corrections needed!", "success");
    } catch (err) {
        showMessage(output, "Network error: " + err.message, "error");
    }
}

/* -------------------------------
      AUTOCOMPLETE FUNCTION
-------------------------------- */
let autoTimer;
document.getElementById("prefix").addEventListener("input", () => {
    clearTimeout(autoTimer);
    autoTimer = setTimeout(getAutocomplete, 200);
});

async function getAutocomplete() {
    const prefix = document.getElementById("prefix").value.trim().toLowerCase();
    const list = document.getElementById("autoList");
    list.innerHTML = "";

    if (!prefix) return;

    try {
        const res = await fetch('http://localhost:3000/autocomplete', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ prefix })
        });
        const data = await res.json();

        if (!data.suggestions || data.suggestions.length === 0) {
            list.innerHTML = "<li>No suggestions</li>";
            return;
        }

        data.suggestions.forEach(s => {
            const li = document.createElement("li");
            li.textContent = s;
            li.addEventListener("click", () => {
                document.getElementById("prefix").value = s;
                list.innerHTML = "";
            });
            list.appendChild(li);
        });
    } catch (err) {
        list.innerHTML = `<li>Error: ${err.message}</li>`;
    }
}
</script>

</body>
</html>
